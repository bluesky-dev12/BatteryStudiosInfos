/*******************************************************************************
 * Decompiled by UE Explorer, an application developed by Eliot van Uytfanghe!
 * Path GUI2K4\Classes\UT2K4SP_Message.uc
 * Package Imports:
 *	GUI2K4
 *	XInterface
 *	Core
 *
 * Stats:
 *	Properties:12
 *	Functions:8
 *
 *******************************************************************************/
class UT2K4SP_Message extends UT2K4GUIPage
    editinlinenew
    instanced;

var() /*0x00000000-0x80000000*/ databinding export editinlinenotify GUIImage imgBackground;
var() /*0x00000000-0x80000000*/ databinding export editinlinenotify GUIImage imgSponsorBg;
var() /*0x00000000-0x80000000*/ databinding export editinlinenotify GUIImage imgSponsor;
var() /*0x00000000-0x80000000*/ databinding export editinlinenotify GUIButton btnOk;
var() /*0x00000000-0x80000000*/ databinding export editinlinenotify GUIButton btnClock;
var() /*0x00000000-0x80000000*/ databinding export editinlinenotify GUISubtitleText sbText;
var localized string Messages[11];
var localized string messageslength[11];
var Sound Sounds[11];
var string screenshots[11];
var int MessageID;
var float oldMusicVol;

event HandleParameters(string Param1, string Param2)
{
    super(GUIPage).HandleParameters(Param1, Param2);
    btnClock.bVisible = Controller.bModAuthor;
    MessageID = int(Param1);
    OpenSound = Sounds[MessageID];
    imgBackground.Image = Material(DynamicLoadObject(screenshots[MessageID], class'Material', true));
    SetTimer(0.10, true);
    oldMusicVol = float(PlayerOwner().ConsoleCommand("get ini:Engine.Engine.AudioDevice MusicVolume"));
    // End:0x118
    if(oldMusicVol > 0.50)
    {
        PlayerOwner().ConsoleCommand("set ini:Engine.Engine.AudioDevice MusicVolume 0.5");
    }
    // End:0x123
    else
    {
        oldMusicVol = -1.0;
    }
}

function bool NotifyLevelChange()
{
    OpenSound = Sounds[MessageID];
    SetTimer(0.10, true);
    LevelChanged();
    return false;
}

function GotoSinglePlayerMenu()
{
    // End:0x4e
    if(ParentPage == none || !ParentPage.IsA('UT2K4SP_Main'))
    {
        Controller.ReplaceMenu("GUI2K4.UT2K4SP_Main", "", "");
    }
    // End:0x5e
    else
    {
        Controller.CloseMenu(true);
    }
}

event Timer()
{
    local float t;

    // End:0xf0
    if(OpenSound != none)
    {
        t = PlayerOwner().GetSoundDuration(Sounds[MessageID]) + 1.0;
        // End:0x6c
        if(messageslength[MessageID] != "")
        {
            sbText.SetSubtitles(Messages[MessageID],, false, messageslength[MessageID]);
        }
        // End:0x86
        else
        {
            sbText.SetSubtitles(Messages[MessageID]);
        }
        // End:0xa7
        if(t <= float(0))
        {
            btnOk.bVisible = true;
        }
        // End:0xe6
        else
        {
            TimerInterval = t;
            // End:0xc7
            if(Controller.bModAuthor)
            {
                StopWatch();
            }
            PlayerOwner().PlayOwnedSound(Sounds[MessageID], 6, 1.0);
        }
        OpenSound = none;
    }
    // End:0xf6
    else
    {
        GotoSinglePlayerMenu();
    }
}

event ChangeHint(string NewHint);
function bool btnOkOnClick(GUIComponent Sender)
{
    GotoSinglePlayerMenu();
    return true;
}

function bool OnClockClick(GUIComponent Sender)
{
    // End:0x16
    if(!Controller.bModAuthor)
    {
        return false;
    }
    StopWatch(true);
    StopWatch();
    return true;
}

function RestoreMusicVolume(bool bCancelled)
{
    // End:0x57
    if(oldMusicVol > float(-1))
    {
        PlayerOwner().ConsoleCommand("set ini:Engine.Engine.AudioDevice MusicVolume" @ string(oldMusicVol));
    }
}

defaultproperties
{
    begin object name=SPMimgBackground class=GUIImage
        ImageStyle=2
        ImageRenderStyle=1
        X1=0
        Y1=0
        X2=1023
        Y2=767
    object end
    // Reference: GUIImage'UT2K4SP_Message.SPMimgBackground'
    imgBackground=SPMimgBackground
    begin object name=SPMbtnOk class=GUIButton
        Caption="??"
        FontScale=0
        WinTop=0.950
        WinLeft=0.4015630
        WinWidth=0.20
        bVisible=true
        OnClick=btnOkOnClick
        OnKeyEvent=InternalOnKeyEvent
    object end
    // Reference: GUIButton'UT2K4SP_Message.SPMbtnOk'
    btnOk=SPMbtnOk
    begin object name=SPMbtnClock class=GUIButton
        Caption="??"
        FontScale=0
        WinTop=0.950
        WinLeft=0.80
        WinWidth=0.20
        bVisible=true
        OnClick=OnClockClick
        OnKeyEvent=InternalOnKeyEvent
    object end
    // Reference: GUIButton'UT2K4SP_Message.SPMbtnClock'
    btnClock=SPMbtnClock
    begin object name=SPPsbText class=GUISubtitleText
        TextColor=(R=255,G=200,B=0,A=225)
        TextFont="UT2SmallHeaderFont"
        VertAlign=2
        ShadowOffsetX=1.0
        ShadowOffsetY=1.0
        HilightColor=(R=255,G=255,B=255,A=128)
        HilightOffsetX=1.0
        HilightOffsetY=1.0
        StyleName=""
        WinTop=0.7816670
        WinLeft=0.020
        WinWidth=0.960
        WinHeight=0.206250
    object end
    // Reference: GUISubtitleText'UT2K4SP_Message.SPPsbText'
    sbText=SPPsbText
    Messages[0]="???? ?????? ???? ??? ????? ????? ???? ???? ??? 12??? ???????.|??? ??? ??????? Malcolm, Gorge, ??? ???? ??? ??? ??? Xan Kriegor ?? ??? ??? ???? ? ????? ??? ??? ??? ?????, ?? ?? ? ??? ?? ???? ???? ????.|??? ?? ????? ???? ???? ????, ?? ????? ???? ??? ??? ?? ????? ???? ???."
    Messages[1]="??? ????? ??? ??? ?? ???? ??? ??? ?? ????? ??????.|??? ?? ????, free-for-all ?????? ???? ?? ????? ????? ?? ??? ??? ??? ???."
    Messages[2]="? ???? ??? ???? ???????.|???? ?? ?? ??? ? ???? ??? ?? ?? ??? ????.|???? ??? ??? ?? ??, ? ? ????(Sun Blade), ?? ??(Super Nova), ??? ????(Juggernauts)?? ??? ???(Goliath)?? ????? ??? ? ????."
    Messages[3]="??? ?? ?? ? ???? ?? ??? ??????.|???? ???? ???? ??? ? ?? ?? ??? ???? ??? ???.|?? ??? ?? ????? ?? ??? ???? ? ????."
    Messages[4]="?? ????? ?? ???? ??????, ?? ? ???  ?? ??? ????? ??????."
    Messages[5]="?? ? ??? ?? ??? ???? ????, ?? ?? ? ?? ??? ????? ??????."
    Messages[6]="?? ? ?? ???? ???????. ?? ??? ?? ??? ??? ??? ???? ????."
    Messages[7]="??? ?? ??? ???(Skaarj) ?? ?? ?? ????? ???????.|?? ?? ??? ??? ??? ??? ?? ???? ? ?? ??? ?? ??? ?? ??(Clan Lord)? ???????.|??? ?? ??(Clan Lord)? ??? ??? ??? ? ? ?? ???(Skaarj)? ????."
    Messages[8]="??? ??? ??(Malcolm)? ??????. ??? ?? ??? ?? ???(Thunder Crash)?? ?? ?? ??? ???????.|??? ??? ??? ??? ?? ?? ?? ???????.|?? ??? ?? ??? ???? ?? ??? ?? ??? ??? ??? ?? ?? ????."
    Messages[9]="???(Corrupt)?? ??? ???? ? ????(Xan Kriegor)? ???????. ??? ???? ?? ??? ???? ????.|?? ?(Xan)? ??? ??, ??? ???(Corrupt)?? ??? ??? ?? ??? ???? ?? ???????."
    Messages[10]="???????! ?? ??? ???? ????? ?? ??? ??? ??? ???? ???"
    messageslength[0]="6.4119|14.8049|99"
    messageslength[1]="6.4471|99"
    messageslength[2]="2.6257|5.7838|99"
    messageslength[3]="2.9667|5.1766|99"
    messageslength[4]="99"
    messageslength[5]="99"
    messageslength[6]="99"
    messageslength[7]="4.7696|7.5625|99"
    messageslength[8]="3.7642|3.9952|99"
    messageslength[9]="5.511|99"
    messageslength[10]="99"
    screenshots[0]="LadderShots.ChampionshipShot"
    screenshots[1]="LadderShots.BRMoneyShot"
    screenshots[2]="LadderShots.TeamDMMoneyShot"
    screenshots[3]="LadderShots.DOMShot"
    screenshots[4]="LadderShots.CTFShot"
    screenshots[5]="LadderShots.BRShot"
    screenshots[6]="LadderShots.TeamDMShot"
    screenshots[7]="LadderShots.DOMMoneyShot"
    screenshots[8]="LadderShots.DOMMoneyShot"
    screenshots[9]="LadderShots.DOMMoneyShot"
    screenshots[10]="LadderShots.DOMMoneyShot"
    OnClose=RestoreMusicVolume
}